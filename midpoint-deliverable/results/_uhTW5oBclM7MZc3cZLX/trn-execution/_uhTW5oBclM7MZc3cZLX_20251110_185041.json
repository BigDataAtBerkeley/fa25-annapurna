{
  "execution_result": {
    "detailed_metrics": {
      "final_epoch_loss": 1.5449,
      "initial_epoch_loss": 2.2905,
      "num_epochs": 5,
      "test_accuracy": 46.06,
      "training_loss": 1.5449
    },
    "execution_time": 103.95,
    "final_epoch_loss": 1.5449,
    "has_evaluation": true,
    "has_training_loop": true,
    "initial_epoch_loss": 2.2905,
    "lines_of_code": 58,
    "num_epochs": 5,
    "peak_memory_mb": 867.4921875,
    "profiler": null,
    "return_code": 0,
    "stderr": "time=\"2025-11-11T02:48:57Z\" level=info msg=\"Running command \\\"/opt/aws_neuronx_venv_pytorch_2_8_nxd_training/bin/python3 /tmp/trainium_exec__uhTW5oBclM7MZc3cZLX_v7mubxfo/main.py\\\" with profiling enabled\"\n/tmp/trainium_exec__uhTW5oBclM7MZc3cZLX_v7mubxfo/main.py:46: DeprecationWarning: Use torch_xla.device instead\n  device = xm.xla_device()\n2025-11-11 02:49:02.571505: W neuron/pjrt-api/neuronpjrt.cc:1972] Use PJRT C-API 0.73 as client did not specify a PJRT C-API version\n/tmp/trainium_exec__uhTW5oBclM7MZc3cZLX_v7mubxfo/main.py:72: DeprecationWarning: Use torch_xla.sync instead\n  xm.mark_step()\n/tmp/trainium_exec__uhTW5oBclM7MZc3cZLX_v7mubxfo/main.py:72: DeprecationWarning: Use torch_xla.sync instead\n  xm.mark_step()\n/tmp/trainium_exec__uhTW5oBclM7MZc3cZLX_v7mubxfo/main.py:72: DeprecationWarning: Use torch_xla.sync instead\n  xm.mark_step()\n/tmp/trainium_exec__uhTW5oBclM7MZc3cZLX_v7mubxfo/main.py:72: DeprecationWarning: Use torch_xla.sync instead\n  xm.mark_step()\nnrtucode: internal error: 54 object(s) leaked, improper teardown\n",
    "stdout": "2025-Nov-11 02:49:07.0758 8280:8319 [1] int nccl_net_ofi_create_plugin(nccl_net_ofi_plugin_t**):213 CCOM WARN NET/OFI Failed to initialize sendrecv protocol\n2025-Nov-11 02:49:07.0768 8280:8319 [1] int nccl_net_ofi_create_plugin(nccl_net_ofi_plugin_t**):354 CCOM WARN NET/OFI aws-ofi-nccl initialization failed\n2025-Nov-11 02:49:07.0778 8280:8319 [1] ncclResult_t nccl_net_ofi_init_no_atexit_fini_v6(ncclDebugLogger_t):183 CCOM WARN NET/OFI Initializing plugin failed\n2025-Nov-11 02:49:07.0788 8280:8319 [1] net_plugin.cc:97 CCOM WARN OFI plugin initNet() failed is EFA enabled?\n2025-11-11 02:49:07.000824:  8280  INFO ||NEURON_CC_WRAPPER||: Call compiler with cmd: neuronx-cc compile --framework=XLA /tmp/ec2-user/neuroncc_compile_workdir/5e272bdb-a2c4-43f1-aaa6-0fa2cfd3ff58/model.MODULE_16457057200261151607+e30acd3a.hlo_module.pb --output /tmp/ec2-user/neuroncc_compile_workdir/5e272bdb-a2c4-43f1-aaa6-0fa2cfd3ff58/model.MODULE_16457057200261151607+e30acd3a.neff --target=trn1 --verbose=35\n.Completed run_backend_driver.\n\nCompiler status PASS\n2025-11-11 02:49:28.000603:  8280  INFO ||NEURON_CC_WRAPPER||: Call compiler with cmd: neuronx-cc compile --framework=XLA /tmp/ec2-user/neuroncc_compile_workdir/73417dca-0c2a-41d5-a998-06971d687d52/model.MODULE_334521436488813455+e30acd3a.hlo_module.pb --output /tmp/ec2-user/neuroncc_compile_workdir/73417dca-0c2a-41d5-a998-06971d687d52/model.MODULE_334521436488813455+e30acd3a.neff --target=trn1 --verbose=35\n.Completed run_backend_driver.\n\nCompiler status PASS\n2025-11-11 02:49:56.000046:  8280  INFO ||NEURON_CC_WRAPPER||: Call compiler with cmd: neuronx-cc compile --framework=XLA /tmp/ec2-user/neuroncc_compile_workdir/286dfdde-a871-4661-9971-7ff570c45e01/model.MODULE_10858212607955724080+e30acd3a.hlo_module.pb --output /tmp/ec2-user/neuroncc_compile_workdir/286dfdde-a871-4661-9971-7ff570c45e01/model.MODULE_10858212607955724080+e30acd3a.neff --target=trn1 --verbose=35\n.Completed run_backend_driver.\n\nCompiler status PASS\nEpoch 1/5, Average Loss: 2.2905\nEpoch 2/5, Average Loss: 2.0507\nEpoch 3/5, Average Loss: 1.8025\nEpoch 4/5, Average Loss: 1.6423\nEpoch 5/5, Average Loss: 1.5449\n2025-11-11 02:50:38.000096:  8280  INFO ||NEURON_CC_WRAPPER||: Using a cached neff at /var/tmp/neuron-compile-cache/neuronxcc-2.21.18209.0+043b1bf7/MODULE_5780227159613568284+e30acd3a/model.neff\n2025-11-11 02:50:39.000762:  8280  INFO ||NEURON_CC_WRAPPER||: Using a cached neff at /var/tmp/neuron-compile-cache/neuronxcc-2.21.18209.0+043b1bf7/MODULE_638626916470604231+e30acd3a/model.neff\nTest Accuracy: 46.06%\n",
    "success": true,
    "test_accuracy": 46.06,
    "timeout": false,
    "training_loss": 1.5449,
    "uses_distributed_training": false
  },
  "metadata": {
    "success": true,
    "execution_time": 103.95,
    "return_code": 0,
    "timeout": false,
    "metrics": {
      "final_epoch_loss": 1.5449,
      "initial_epoch_loss": 2.2905,
      "num_epochs": 5,
      "test_accuracy": 46.06,
      "training_loss": 1.5449
    },
    "execution_time_seconds": 104.35731482505798
  },
  "stdout": "2025-Nov-11 02:49:07.0758 8280:8319 [1] int nccl_net_ofi_create_plugin(nccl_net_ofi_plugin_t**):213 CCOM WARN NET/OFI Failed to initialize sendrecv protocol\n2025-Nov-11 02:49:07.0768 8280:8319 [1] int nccl_net_ofi_create_plugin(nccl_net_ofi_plugin_t**):354 CCOM WARN NET/OFI aws-ofi-nccl initialization failed\n2025-Nov-11 02:49:07.0778 8280:8319 [1] ncclResult_t nccl_net_ofi_init_no_atexit_fini_v6(ncclDebugLogger_t):183 CCOM WARN NET/OFI Initializing plugin failed\n2025-Nov-11 02:49:07.0788 8280:8319 [1] net_plugin.cc:97 CCOM WARN OFI plugin initNet() failed is EFA enabled?\n2025-11-11 02:49:07.000824:  8280  INFO ||NEURON_CC_WRAPPER||: Call compiler with cmd: neuronx-cc compile --framework=XLA /tmp/ec2-user/neuroncc_compile_workdir/5e272bdb-a2c4-43f1-aaa6-0fa2cfd3ff58/model.MODULE_16457057200261151607+e30acd3a.hlo_module.pb --output /tmp/ec2-user/neuroncc_compile_workdir/5e272bdb-a2c4-43f1-aaa6-0fa2cfd3ff58/model.MODULE_16457057200261151607+e30acd3a.neff --target=trn1 --verbose=35\n.Completed run_backend_driver.\n\nCompiler status PASS\n2025-11-11 02:49:28.000603:  8280  INFO ||NEURON_CC_WRAPPER||: Call compiler with cmd: neuronx-cc compile --framework=XLA /tmp/ec2-user/neuroncc_compile_workdir/73417dca-0c2a-41d5-a998-06971d687d52/model.MODULE_334521436488813455+e30acd3a.hlo_module.pb --output /tmp/ec2-user/neuroncc_compile_workdir/73417dca-0c2a-41d5-a998-06971d687d52/model.MODULE_334521436488813455+e30acd3a.neff --target=trn1 --verbose=35\n.Completed run_backend_driver.\n\nCompiler status PASS\n2025-11-11 02:49:56.000046:  8280  INFO ||NEURON_CC_WRAPPER||: Call compiler with cmd: neuronx-cc compile --framework=XLA /tmp/ec2-user/neuroncc_compile_workdir/286dfdde-a871-4661-9971-7ff570c45e01/model.MODULE_10858212607955724080+e30acd3a.hlo_module.pb --output /tmp/ec2-user/neuroncc_compile_workdir/286dfdde-a871-4661-9971-7ff570c45e01/model.MODULE_10858212607955724080+e30acd3a.neff --target=trn1 --verbose=35\n.Completed run_backend_driver.\n\nCompiler status PASS\nEpoch 1/5, Average Loss: 2.2905\nEpoch 2/5, Average Loss: 2.0507\nEpoch 3/5, Average Loss: 1.8025\nEpoch 4/5, Average Loss: 1.6423\nEpoch 5/5, Average Loss: 1.5449\n2025-11-11 02:50:38.000096:  8280  INFO ||NEURON_CC_WRAPPER||: Using a cached neff at /var/tmp/neuron-compile-cache/neuronxcc-2.21.18209.0+043b1bf7/MODULE_5780227159613568284+e30acd3a/model.neff\n2025-11-11 02:50:39.000762:  8280  INFO ||NEURON_CC_WRAPPER||: Using a cached neff at /var/tmp/neuron-compile-cache/neuronxcc-2.21.18209.0+043b1bf7/MODULE_638626916470604231+e30acd3a/model.neff\nTest Accuracy: 46.06%\n",
  "stderr": "time=\"2025-11-11T02:48:57Z\" level=info msg=\"Running command \\\"/opt/aws_neuronx_venv_pytorch_2_8_nxd_training/bin/python3 /tmp/trainium_exec__uhTW5oBclM7MZc3cZLX_v7mubxfo/main.py\\\" with profiling enabled\"\n/tmp/trainium_exec__uhTW5oBclM7MZc3cZLX_v7mubxfo/main.py:46: DeprecationWarning: Use torch_xla.device instead\n  device = xm.xla_device()\n2025-11-11 02:49:02.571505: W neuron/pjrt-api/neuronpjrt.cc:1972] Use PJRT C-API 0.73 as client did not specify a PJRT C-API version\n/tmp/trainium_exec__uhTW5oBclM7MZc3cZLX_v7mubxfo/main.py:72: DeprecationWarning: Use torch_xla.sync instead\n  xm.mark_step()\n/tmp/trainium_exec__uhTW5oBclM7MZc3cZLX_v7mubxfo/main.py:72: DeprecationWarning: Use torch_xla.sync instead\n  xm.mark_step()\n/tmp/trainium_exec__uhTW5oBclM7MZc3cZLX_v7mubxfo/main.py:72: DeprecationWarning: Use torch_xla.sync instead\n  xm.mark_step()\n/tmp/trainium_exec__uhTW5oBclM7MZc3cZLX_v7mubxfo/main.py:72: DeprecationWarning: Use torch_xla.sync instead\n  xm.mark_step()\nnrtucode: internal error: 54 object(s) leaked, improper teardown\n"
}